웹 클로러는 전통적으로 파이썬이 강자입니다.
/robots.txt 가이드에 따르면 예의가 바른 크롤러 짓입니다.

오늘 알아 볼 것은 프로그래밍 안하고,? 크롤링 하는 두 가지를 소개하려고 합니다.

아, 그리고, 2일 전 박재호님과의 방송에서 채팅창에 후원해 주신 분 감사합니다.
20년 전 `나는 프로그래머다` 막내 저자로 참여했었는데, 그 책도 읽어주셨다니, 고맙습니다.🙇🏻‍♂️

이제 시작하겠습니다.
오늘은 스팟 인스턴스에서 시작하겠습니다.
EC2 노는 자원을 헐값(최대 90% 할인 DC)에 사용할 수 있습니다.
**안정성은 보장**이 _안 되지_ 만, 테스트할 때는 이보다 좋은 인스턴스가 없습니다.

캡처한 이미지 먼저 보시죠.
spot 안 쓰고 on-demand 인스턴스라면 105 * 1400원 인데, 13 * 1400원만 쓰면 됩니다.
87% 절약

시작합니다.
https://okdevtv.com/mib/nutch 스크립트 참고하시면 됩니다.
~~살짝 민망합니다잉~~

20년쯤 전에 천재 프로그래머가 있었습니다. 더그 커팅, 뭘 커팅하시는 건지 
> 자바를 한 번 배워볼까?

생각을 하셨다고 합니다.
> 근데, 문법만 익히는 공부는 재미 없으니까, 
> 검색 엔진이나 만들어야 겠다.

해서 만든 것이 https://lucene.apache.org 그 전설의 루씬입니다.

검색엔진을 만들다 보니 검색할 게 없는 것입니다.
그래서 웹 크롤러를 만든 게 nutch 입니다.
https://nutch.apache.org

그리고, 웹 크롤링을 해서 데이터를 저장하는데 저장 공간 이슈가 생긴 겁니다.
그래서 만든 게 뭘까요?
하둡입니다. https://hadoop.apache.org

2004년 공개된 구글의 storage 관련 논문(Google File System; GFS)이 있었죠.
https://takeanoteof.tistory.com/46

2006년에 공개된 hadoop이 이제는 그냥 공공재(오픈 소스)의 근간이 된 것 같습니다.

서론이 길었고, 스팟 인스턴스 만들겠습니다.

스팟 요청을 하면 `자바 2명 타요` 느낌으로 노는 인스턴스 자격 조건을 설정할 수 있습니다.
on demand처럼 바로 되는 것이 아니라 상황에 따라서 취소 될 수도 있습니다.

추가 시작 파라미터 <-- 스토리지 공간은 필요에 따라 정합니다. 저는 30기가로 시작하겠습니다.
타이핑이 안되기 때문에 오른쪽에 삼각형을 클릭해야 됩니다.

요즘은 컴퓨팅 자원이 쎄져서 8기가 메모리도 많이 허덕이는 세상입니다.

일단 16~32 로 인스턴스 1개를 만듭니다.
fleet 플릿은 함대라는 뜻입니다. 동시에 항공모함 주변의 배들 처럼 인스턴스가 갑자기 많이 나타납니다.

z1d.large 인스턴스는 첨 봐요
z1d.large price
고주파는 왜 컴퓨팅에 필요한지 이해는 안 가지만, 일단 얼마나 저렴 한 지 확인해 보겠습니다.

$0.23
온디맨드 합계
$0.03
스팟 합계
87%
절감

시간당 0.23인데, 참고로 t2.micro가 시간당 0.014 정도입니다.
23 / 0.14 = ? 약 20배 차이 납니다. 87% 저렴합니다.
원화로 계산하면 1시간에 0.23 * 1400 = ??? 
아하하하핳 1000 * 0.2 = 200원 이니까, 대략 500원은 안 넘겠죠.

인스턴스 메뉴에 새로 보이는 게 있습니다. 
접속하고, 크롤링 환경 설정하고, 돌려 보겠습니다.

ssh -i ~/keys/okkyelk.pem ec2-user@43.200.171.119

접속하고 일단 zsh을 설치합니다.
https://okdevtv.com/mib/aws/basic

아 망했습니다. 스팟 인스턴스의 기본 이미지는 작년 이전의 것입니다.
2023으로 이미지 검색해서 다시 시작하겠습니다.

fleet함대 접어!
그럼 스팟 인스턴스는 자동으로 꺼집니다.
마치 나루토의 그림자분신술처럼요


다시 시작하겠습니다.

스팟 인스턴스로 nutch 실행 가능한 환경을 만들고 https://mp4.okdevtv.com 사이트를 크롤링 해 보겠습니다.

대박 [Confluent Community Catalyst 선정! 카프카 개발자를 위한 특별한 선물 언박싱!](https://youtu.be/6DrmTTyEmw0)
🐶부럽네요.

다시 만들겠습니다. 2023 AMI 필요합니다.
추가 시작 파라미터에서 스토리지 용량을 8 -> 30 으로 올립니다. 필요에 따라 30은 달라질 수 있습니다.

메모리 16G 이상 32G 이하
거의 노트북 느낌이죠.

인스턴스 1개 바로 시작될 겁니다.

zsh의 plugin 문법 하일라이트 기능 플러그인 설치 필요합니다.

nutch 다운 압풀 완료입니다.

아직도 자바를 8 쓰시면 쫌. ㅠㅠ

`vi urls/seed.txt`
https://mp4.okdevtv.com/

내용 집어넣었습니다.

이렇게 하면 준수하게 크롤링 할 수 있습니다.

---
잠시만요. 급 배탈이라 ㅠㅠ

21:30 에 재개(다시시작) 하겠습니다.

---
기다려 주셔서 감사합니다.
인터넷 속도가 
fast.com 에서 체크 좀 하겠습니다.

비가 온 날 이라 그런지 쫌 거시기 합니다. #속도

탐색하는 seed는 https://mp4.okdevtv.com/ 확인했습니다.

https://okdevtv.com/mib/nutch 이어 가겠습니다.

일단 긁겠습니다. 크로울
crawl

```sh
bin/crawl inject crawl/crawldb urls
```

이건 제가 업데이트 하겠습니다.

끝났네요.
2 를 4로 바꿔 보겠습니다.

2에서 4로 바꿨는데, 링크가 기하급수적으로 ㅠㅠ

사이트 제한을 두어야 겠습니다.

아주 거미(web spider)가 미쳐서 날 뛰 고 있습니다. ㅠㅠ

참고로 셀레늄이 없기 때문에 js로 렌더링된 링크는 제외됩니다.
URL 베이스의 크롤링만 합니다.

일단 여기까지

crawl 폴더 아래 segments 담겨 있는 내용을
solr 에 담아서 json 으로 보겠습니다.

solr 서버는 띄웠고, core 생성합니다. 이름은 nutch 입니다.

여튼 크롤링은 일단 시작은 되었습니다.

다음 방송에서는 조금 더 괜찮은 스킬을 공유하겠습니다.

시청 감사합니다. ☺️
좋은 일요일 되시길 바랍니다.

https://mp4.okdevtv.com 에는 여러분이 상상도 못 하는 좋은 개발 유튜버들의 영상이 매일 차곡차곡 쌓이고 있습니다.

그리고, 뒷광고인데 아래 있는 이 링크 많관부
- [VS Code에서 쉽게 사용하는 Git: https://inf.run/LPpDg](https://inf.run/LPpDg), [Udemy](https://www.udemy.com/course/git-vscode/?referralCode=B8C18816E4B041590CF7)  
- [React + API Server 프로젝트 개발과 배포 (CI/CD): https://inf.run/Q7Ld1](https://inf.run/Q7Ld1) - 50% 할인 쿠폰 코드: `15108-f2af1e086101`

행복기원! 🙏
